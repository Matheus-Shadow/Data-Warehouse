SELECT
    CAST(R.DT_PGTO_REC AS DATETIME2) AS DATA,
    CAST(230 AS INT) AS COD_CRM,
    CAST(REPLACE(T.CONTRATO_TIT, '.', '') AS BIGINT) AS ID_ACORDO,
    CAST(VD.CPFCGC_PES AS VARCHAR(20)) AS CPF,
    CAST(R.COD_TIT AS BIGINT) AS ID_KEY,
    CAST(VF.NOME_FUNC AS NVARCHAR(50)) AS USUARIO_PAGAMENTO,
    CAST(VF.NOME_FUNC AS NVARCHAR(150)) AS OPERADOR,
    CAST(R.FORMA_PG_REC AS INT) AS TIPO_PAGAMENTO,
    CAST(VPGTO.DES_PGTO AS NVARCHAR(100)) AS TIPO_PAGAMENTO_NOME,
    CAST(R.VALOR_RECEBIDO_REC AS NUMERIC(9,2)) AS VALOR_PAGAMENTO,
    CAST('52.179.19.141' AS VARCHAR(20)) AS INSTANCIA,
    CAST('MF_cobsystems' AS VARCHAR(20)) AS BANCO,
    CAST('VCOM' AS VARCHAR(30)) AS ORIGEM

FROM TITULOS T WITH (NOLOCK)
INNER JOIN RECEBIMENTOS R ON R.COD_TIT = T.COD_TIT
INNER JOIN v_devedores VD ON T.COD_DEV = VD.COD_DEV
INNER JOIN V_FUNCIONARIOS VF ON R.USUARIO_CAD = VF.COD_FUNC
INNER JOIN V_FORMA_PGTO VPGTO ON VPGTO.COD_PGTO = R.FORMA_PG_REC
ORDER BY 1 DESC
